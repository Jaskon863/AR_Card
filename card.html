<!-- import aframe and then ar.js with image tracking / location based features -->
<script src="../js/aframe-master.min.js"></script>
<script src="../js/aframe-ar-nft.js"></script>
<script src="https://unpkg.com/aframe-particle-system-component@1.0.x/dist/aframe-particle-system-component.min.js"></script>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<script>
  window.onload = function() {
      AFRAME.registerComponent('videohandler', {
          init: function () {
              var marker = this.el;

              this.vid = document.querySelector("#vid");

              marker.addEventListener('markerFound', function () {
                  this.vid.play();
              }.bind(this));

  marker.addEventListener('markerLost', function() {
    this.vid.pause();
    //this.vid.currentTime = 0;
  }.bind(this));
          }
      });
  };
</script>
<!-- style for the loader -->
<style>
  .arjs-loader {
    height: 100%;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .arjs-loader div {
    text-align: center;
    font-size: 1.25em;
    color: white;
  }
</style>

<body style="margin: 0px; overflow: hidden">
  <!-- minimal loader shown until image descriptors are loaded. Loading may take a while according to the device computational power -->
  <div class="arjs-loader">
    <div>正在加载AR模型，请稍候...</div>
  </div>

  <!-- a-frame scene -->
  <a-scene
    vr-mode-ui="enabled: false;"
    renderer="logarithmicDepthBuffer: true;"
    embedded
    arjs="trackingMethod: best; sourceType: webcam;debugUIEnabled: false;"
  >
    <a-assets>
      <!-- <img id="pic" src="../images/cx.jpg" /> -->
      <!-- <img id="logo" src="../images/buptlogo.jpg" /> -->
      <img crossorigin="anonymous" id="logo" src="../images/buptlogo.jpg">
      <img crossorigin="anonymous" id="headshotTexture" src="../images/cx.jpg">
      <video src="../images/ebupt.mp4"
                preload="auto" id="vid" response-type="arraybuffer" loop
                crossorigin webkit-playsinline autoplay muted playsinline>
      </video>
      <a-asset-item id="shiba" src="/model/shiba/scene.gltf"></a-asset-item>
    </a-assets>
    <!-- a-nft is the anchor that defines an Image Tracking entity -->
    <!-- on 'url' use the path to the Image Descriptors created before. -->
    <!-- 路径不带文件拓展名！【注意】以网站的域名为相对路径 -->
    <a-nft
      type="nft"
      url="descriptors/Card/Card"
      videohandler
      smooth="true"
      smoothCount="10"
      smoothTolerance="1"
      smoothThreshold="10">
      <!-- <a-entity id="stars"
        particle-system="preset: default; color: #515; particleCount: 30; maxAge: 2; randomize: false; blending: 1; opacity: .5; velocityValue:'50 10 0'"
        position="0.1 0.1 0.1" rotation="-90 0 0" direction="-1"></a-entity> -->
      <a-entity 
        scale="200 200 200" 
        position="0.1 0.1 0.1" 
        rotation="-90 0 0">
        <a-video
                src="#vid"
                position='0.667 1.402 -2'
                rotation='0 0 0'
                width='30'
                height='17.5'
                scale="0.03 0.03 1"
                controls autoplay
                >
        </a-video>
    <a-box 
        scale="0.9 0.2 0.3"
        material="src: #logo"
        position="-0.54 1.486 -2" 
        rotation="0 0 0"
        radius="2" 
        segments-height="36">
        <a-animation attribute="rotation" loop="true" dur="2000" fill="backwards"
        to="0 360 0" ease="linear"></a-animation>
    </a-box> 
    <a-box 
      depth="0.2"
      scale="0.5 0.5 0.5"
      material="src: #headshotTexture"
      position="0.158 0.837 -2" 
      radius="2" 
      segments-height="36">
    </a-box>
      </a-entity>

    <a-entity
    gltf-model="/model/shiba/scene.gltf"
    scale="30 30 30"
    position="-47.4 -116 -170.9"
    rotation="-90 0 0">
    </a-entity>
    <a-entity
    gltf-model="/model/dragon/scene.gltf"
    scale="30 30 30"
    position="-47.4 -116 -100.9"
    rotation="-90 0 0">
    </a-entity>
    <a-text
          value="北京邮电大学\n陈祥"
          font="custom-msdf.json"
          position="0 1 0"
          color="black"
          depth="0.5"
          scale="1 1 1">
    </a-text>

    <a-entity position="-0.14 0 -2" rotation="0 0 0" scale="0.04 0.1 0.16"
      text-geometry="bevelEnabled:true;bevelSize:0.1;bevelThickness:0.1;curveSegments:1;
      font:	https://rawgit.com/ngokevin/kframe/master/components/text-geometry/lib/helvetiker_regular.typeface.json;
      height:0.5;size:1;
      value:Cesar"
      material="color:#87CEFA;"
      >
      </a-entity>
      <a-entity position="-0.14 0.1 -2" rotation="0 0 0" scale="0.04 0.1 0.16"
        text-geometry="bevelEnabled:true;bevelSize:0.1;bevelThickness:0.1;curveSegments:1;
        font:	https://rawgit.com/ngokevin/kframe/master/components/text-geometry/lib/helvetiker_regular.typeface.json;
        height:0.5;size:1;
        value:2019210987"
        material="color:#87CEFA;"
        >
      </a-entity>
      <a-entity position="-0.14 0.2 -2" rotation="0 0 0" scale="0.04 0.1 0.16"
        text-geometry="bevelEnabled:true;bevelSize:0.1;bevelThickness:0.1;curveSegments:1;
        font:	https://rawgit.com/ngokevin/kframe/master/components/text-geometry/lib/helvetiker_regular.typeface.json;
        height:0.5;size:1;
        value:Today is a good day"
        material="color:#87CEFA;"
        >
      </a-entity>
      
     
      
        <!-- <a-text
          value="北京邮电大学\n陈祥"
          font="custom-msdf.json"
          position="0 1 0"
          color="black"
          depth="0.5"
          scale="1 1 1">
        </a-text>
        <a-text
          value="Major:Computer Science\nnumber:2019210987
        motto:You are awesome!"
          position="0 0.65 0"
          color="black"
          scale="0.5 0.5 0.5"
        ></a-text>  -->
      
        <!-- <a-link 
          class="clickable" 
          href="https://www.ebupt.com/" 
          title="" 
          image="" 
          position="2.2 0.0 -.33"
          rotation="0 0 0" 
          scale="0.6 0.6 0.6" 
          geometry="primitive:circle;segments:64"
          material="shader:portal;side:double;visible:false" 
          link="title:.">

        <a-box scale="0.4 0.4 0.4" material="src:#logo"
        position="0.09854454977856898 0.0036935886841299587 -0.2155814669584256" radius="2" segments-height="84"
        rotation="-23.450000000000003 0 0" geometry="">
        
        </a-box> 
      </a-link>-->
      
      <!-- <a-entity
        gltf-model="model/shiba/scene.gltf"
        scale="50 50 50"
        position="0.1 0 0"
        rotation="-90 0 0"
      >
      </a-entity>
      <a-video
                src="#vid"
                position='200 0 -300'
                rotation='-90 0 0'
                width='300'
                height='175'
                controls autoplay
                >
      </a-video> -->
      <!-- <a-entity position="0.1 0.1 0.1" rotation="0 0 0" scale="100 100 100"
        text-geometry="bevelEnabled:true;bevelSize:0.1;bevelThickness:0.1;curveSegments:1;
        font:	https://rawgit.com/ngokevin/kframe/master/components/text-geometry/lib/helvetiker_regular.typeface.json;
        height:0.5;size:2;
        value:B u p t"
        material="color:#87CEFA;"
        >
      </a-entity> -->
    </a-nft>
    <!-- static camera that moves according to the device movemenents -->
    <a-entity camera="fov: 190"></a-entity>
  </a-scene>
</body>
